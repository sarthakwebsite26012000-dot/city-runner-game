<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Runner - Endless Runner Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        #game-container { position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.3); }
        #gameCanvas { border: 3px solid #333; background: #87CEEB; display: block; }
        #ui { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        #score, #coins {
            position: absolute; top: 10px; background: rgba(0,0,0,0.7);
            color: #FFD700; padding: 10px 20px; font-size: 20px;
            font-weight: bold; border-radius: 5px; pointer-events: all;
        }
        #score { left: 10px; }
        #coins { right: 10px; }
        #gameOver, #startScreen {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); color: white; padding: 40px;
            border-radius: 10px; text-align: center; pointer-events: all;
        }
        #gameOver h1, #startScreen h1 { color: #FFD700; margin-bottom: 20px; }
        button {
            background: #4CAF50; color: white; border: none;
            padding: 15px 30px; font-size: 18px; cursor: pointer;
            border-radius: 5px; margin-top: 20px; transition: background 0.3s;
        }
        button:hover { background: #45a049; }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="ui">
            <div id="score">Score: 0</div>
            <div id="coins">Coins: 0</div>
            <div id="gameOver" style="display:none">
                <h1>Game Over!</h1>
                <p>Final Score: <span id="finalScore">0</span></p>
                <button onclick="restartGame()">Restart</button>
            </div>
            <div id="startScreen">
                <h1>City Runner</h1>
                <p>Use Arrow Keys:</p>
                <p>↑ Jump | ↓ Slide | ← → Change Lanes</p>
                <button onclick="startGame()">Start Game</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let gameRunning = false, score = 0, coins = 0, speed = 5, gameLoop;
        
        const player = { x: 400, y: 450, width: 40, height: 60, lane: 1, jumping: false, sliding: false, velocityY: 0, gravity: 0.8, jumpPower: -15 };
        const lanes = [300, 400, 500];
        let obstacles = [], coinsList = [], powerUps = [];
        let magnetActive = false, shieldActive = false, magnetTimer = 0, shieldTimer = 0;
        
        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            switch(e.key) {
                case 'ArrowLeft': if (player.lane > 0) player.lane--; break;
                case 'ArrowRight': if (player.lane < 2) player.lane++; break;
                case 'ArrowUp':
                    if (!player.jumping && !player.sliding) {
                        player.jumping = true; player.velocityY = player.jumpPower;
                    }
                    break;
                case 'ArrowDown':
                    if (!player.jumping && !player.sliding) {
                        player.sliding = true;
                        setTimeout(() => player.sliding = false, 500);
                    }
                    break;
            }
        });
        
        function spawnObstacle() {
            obstacles.push({
                x: lanes[Math.floor(Math.random() * 3)],
                y: -50, width: 40,
                height: Math.random() > 0.5 ? 40 : 30,
                type: Math.random() > 0.5 ? 'jump' : 'slide'
            });
        }
        
        function spawnCoin() {
            coinsList.push({ x: lanes[Math.floor(Math.random() * 3)], y: -50, width: 30, height: 30 });
        }
        
        function spawnPowerUp() {
            powerUps.push({
                x: lanes[Math.floor(Math.random() * 3)],
                y: -50, width: 35, height: 35,
                type: Math.random() > 0.5 ? 'magnet' : 'shield'
            });
        }
        
        function drawPlayer() {
            player.x += (lanes[player.lane] - player.x) * 0.2;
            if (player.jumping) {
                player.velocityY += player.gravity; player.y += player.velocityY;
                if (player.y >= 450) { player.y = 450; player.jumping = false; player.velocityY = 0; }
            }
            const h = player.sliding ? 30 : 60, y = player.sliding ? player.y + 30 : player.y;
            ctx.fillStyle = shieldActive ? '#00FFFF' : '#FF6B6B';
            ctx.fillRect(player.x - player.width/2, y, player.width, h);
            ctx.fillStyle = '#000';
            ctx.fillRect(player.x - 15, y + 10, 10, 10);
            ctx.fillRect(player.x + 5, y + 10, 10, 10);
        }
        
        function drawObstacles() {
            obstacles.forEach((obs, i) => {
                obs.y += speed;
                ctx.fillStyle = obs.type === 'jump' ? '#8B4513' : '#FF4500';
                ctx.fillRect(obs.x - obs.width/2, obs.y, obs.width, obs.height);
                if (obs.y > 600) { obstacles.splice(i, 1); score += 10; }
            });
        }
        
        function drawCoins() {
            coinsList.forEach((coin, i) => {
                coin.y += speed;
                if (magnetActive && Math.abs(coin.x - player.x) < 150)
                    coin.x += (player.x - coin.x) * 0.1;
                ctx.fillStyle = '#FFD700';
                ctx.beginPath(); ctx.arc(coin.x, coin.y + 15, 15, 0, Math.PI * 2); ctx.fill();
                ctx.strokeStyle = '#FFA500'; ctx.lineWidth = 3; ctx.stroke();
                if (coin.y > 600) coinsList.splice(i, 1);
            });
        }
        
        function drawPowerUps() {
            powerUps.forEach((pu, i) => {
                pu.y += speed;
                ctx.fillStyle = pu.type === 'magnet' ? '#9C27B0' : '#00BCD4';
                ctx.fillRect(pu.x - pu.width/2, pu.y, pu.width, pu.height);
                ctx.fillStyle = '#FFF'; ctx.font = '20px Arial';
                ctx.fillText(pu.type === 'magnet' ? 'M' : 'S', pu.x - 8, pu.y + 23);
                if (pu.y > 600) powerUps.splice(i, 1);
            });
        }
        
        function checkCollisions() {
            const pH = player.sliding ? 30 : 60, pY = player.sliding ? player.y + 30 : player.y;
            obstacles.forEach(obs => {
                if (Math.abs(obs.x - player.x) < 35 && obs.y > pY - 10 && obs.y < pY + pH) {
                    if ((obs.type === 'jump' && !player.jumping) || (obs.type === 'slide' && !player.sliding)) {
                        if (!shieldActive) endGame();
                        else obstacles.splice(obstacles.indexOf(obs), 1);
                    }
                }
            });
            coinsList.forEach((coin, i) => {
                if (Math.abs(coin.x - player.x) < 35 && coin.y > pY - 10 && coin.y < pY + pH) {
                    coins++; score += 5; coinsList.splice(i, 1);
                }
            });
            powerUps.forEach((pu, i) => {
                if (Math.abs(pu.x - player.x) < 35 && pu.y > pY - 10 && pu.y < pY + pH) {
                    if (pu.type === 'magnet') { magnetActive = true; magnetTimer = 300; }
                    else { shieldActive = true; shieldTimer = 300; }
                    powerUps.splice(i, 1);
                }
            });
        }
        
        function updatePowerUps() {
            if (magnetActive) { magnetTimer--; if (magnetTimer <= 0) magnetActive = false; }
            if (shieldActive) { shieldTimer--; if (shieldTimer <= 0) shieldActive = false; }
        }
        
        function drawBackground() {
            ctx.fillStyle = '#87CEEB'; ctx.fillRect(0, 0, 800, 600);
            ctx.strokeStyle = '#555'; ctx.lineWidth = 2;
            for (let i = 0; i < 3; i++) {
                ctx.beginPath();
                ctx.moveTo(lanes[i] - 50, 0); ctx.lineTo(lanes[i] - 50, 600); ctx.stroke();
                ctx.moveTo(lanes[i] + 50, 0); ctx.lineTo(lanes[i] + 50, 600); ctx.stroke();
            }
        }
        
        function update() {
            if (!gameRunning) return;
            ctx.clearRect(0, 0, 800, 600);
            drawBackground(); drawObstacles(); drawCoins(); drawPowerUps(); drawPlayer();
            checkCollisions(); updatePowerUps(); speed += 0.001;
            document.getElementById('score').textContent = 'Score: ' + Math.floor(score);
            document.getElementById('coins').textContent = 'Coins: ' + coins;
        }
        
        let obstacleTimer = 0, coinTimer = 0, powerUpTimer = 0;
        
        function startGame() {
            gameRunning = true; score = 0; coins = 0; speed = 5;
            obstacles = []; coinsList = []; powerUps = [];
            player.lane = 1; player.jumping = false; player.sliding = false;
            magnetActive = false; shieldActive = false;
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';
            gameLoop = setInterval(() => {
                update(); obstacleTimer++; coinTimer++; powerUpTimer++;
                if (obstacleTimer > 80) { spawnObstacle(); obstacleTimer = 0; }
                if (coinTimer > 50) { spawnCoin(); coinTimer = 0; }
                if (powerUpTimer > 400) { spawnPowerUp(); powerUpTimer = 0; }
            }, 1000/60);
        }
        
        function endGame() {
            gameRunning = false; clearInterval(gameLoop);
            document.getElementById('finalScore').textContent = Math.floor(score);
            document.getElementById('gameOver').style.display = 'block';
        }
        
        function restartGame() { startGame(); }
    </script>
</body>
</html>
